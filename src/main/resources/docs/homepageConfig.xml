<?xml version="1.0" encoding="UTF-8"?>
<!--

    Licensed to the Austrian Association for Software Tool Integration (AASTI)
    under one or more contributor license agreements. See the NOTICE file
    distributed with this work for additional information regarding copyright
    ownership. The AASTI licenses this file to you under the Apache License,
    Version 2.0 (the "License"); you may not use this file except in compliance
    with the License. You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->

<c:config xmlns="http://maven.apache.org/POM/4.0.0" xmlns:c="http://www.openengsb.org/openengsb-maven-plugin/CoCProfile">
  <resources>
    <resource>
      <directory>${project.basedir}/src/site</directory>
      <filtering>true</filtering>
      <includes>
        <include>**/*</include>
      </includes>
      <excludes>
        <exclude>**/*.pdf</exclude>
      </excludes>
    </resource>
    <resource>
      <directory>${project.basedir}/src/site</directory>
      <filtering>false</filtering>
      <includes>
        <include>**/*.pdf</include>
      </includes>
    </resource>
  </resources>
  <plugins>
    <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-resources-plugin</artifactId>
      <configuration>
        <useDefaultDelimiters>false</useDefaultDelimiters>
        <delimiters>
          <delimiter>${*}</delimiter>
        </delimiters>
      </configuration>
      <executions>
        <execution>
          <id>filter</id>
          <phase>generate-resources</phase>
          <goals>
            <goal>resources</goal>
          </goals>
        </execution>
      </executions>
    </plugin>
    <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-dependency-plugin</artifactId>
      <executions>
        <execution>
          <id>unpack</id>
          <phase>generate-resources</phase>
          <goals>
            <goal>unpack</goal>
          </goals>
          <configuration>
            <artifactItems>
              <artifactItem>
                <groupId>org.openengsb.docs</groupId>
                <artifactId>openengsb-docs-manual</artifactId>
                <version>${project.version}</version>
                <type>zip</type>
                <classifier>html-multi</classifier>
              </artifactItem>
              <artifactItem>
                <groupId>org.openengsb.docs</groupId>
                <artifactId>openengsb-docs-manual</artifactId>
                <version>${project.version}</version>
                <type>zip</type>
                <classifier>html-single</classifier>
              </artifactItem>
              <artifactItem>
                <groupId>org.openengsb.docs</groupId>
                <artifactId>openengsb-docs-manual</artifactId>
                <version>${project.version}</version>
                <type>zip</type>
                <classifier>pdf</classifier>
              </artifactItem>
            </artifactItems>
            <outputDirectory>${project.build.directory}</outputDirectory>
            <overWriteReleases>true</overWriteReleases>
            <overWriteSnapshots>true</overWriteSnapshots>
            <stripVersion>true</stripVersion>
          </configuration>
        </execution>
      </executions>
    </plugin>
    <plugin>
      <groupId>net.sourceforge.docbook-utils.maven-plugin</groupId>
      <artifactId>maven-tidy-plugin</artifactId>
      <version>1.0.0.beta-1</version>
      <executions>
        <execution>
          <phase>process-resources</phase>
          <goals>
            <goal>tidy</goal>
          </goals>
        </execution>
      </executions>
      <configuration>
        <sourceDir>${project.build.directory}/openengsb-docs-manual-${project.version}/manual/html-multi/</sourceDir>
        <destinationDir>${project.build.directory}/generated-site/xhtml/docbook</destinationDir>
        <replaceExtensionMap>
          <html>xhtml</html>
        </replaceExtensionMap>
        <jtidyConfiguration>
          <property>
            <name>output-encoding</name>
            <value>UTF-8</value>
          </property>
          <property>
            <name>add-xml-space</name>
            <value>true</value>
          </property>
          <property>
            <name>char-encoding</name>
            <value>UTF-8</value>
          </property>
          <property>
            <name>quiet</name>
            <value>true</value>
          </property>
          <property>
            <name>quote-nbsp</name>
            <value>false</value>
          </property>
          <property>
            <name>output-xhtml</name>
            <value>true</value>
          </property>
          <property>
            <name>indent</name>
            <value>true</value>
          </property>
          <property>
            <name>wrap</name>
            <value>120</value>
          </property>
          <property>
            <name>write-back</name>
            <value>true</value>
          </property>
        </jtidyConfiguration>
      </configuration>
    </plugin>
    <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-site-plugin</artifactId>
      <dependencies>
        <dependency>
          <groupId>org.apache.maven.doxia</groupId>
          <artifactId>doxia-module-xhtml</artifactId>
          <version>1.1.4</version>
        </dependency>
      </dependencies>
      <configuration>
        <siteDirectory>${basedir}/target/classes</siteDirectory>
        <outputEncoding>UTF-8</outputEncoding>
        <reportPlugins>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-project-info-reports-plugin</artifactId>
            <version>${maven.plugin.project.info.reports.version}</version>
            <configuration>
              <webAccessUrl>http://github.com/openengsb/openengsb</webAccessUrl>
              <anonymousConnection>scm:git:git://github.com/openengsb/openengsb.git</anonymousConnection>
              <developerConnection>scm:git:git@github.com:openengsb/openengsb.git</developerConnection>
            </configuration>
            <reportSets>
              <reportSet>
                <reports>
                  <report>project-team</report>
                  <report>mailing-list</report>
                  <report>cim</report>
                  <report>issue-tracking</report>
                  <report>license</report>
                  <report>scm</report>
                </reports>
              </reportSet>
            </reportSets>
          </plugin>
        </reportPlugins>
      </configuration>
      <executions>
        <execution>
          <id>mvnSite</id>
          <phase>package</phase>
          <goals>
            <goal>site</goal>
          </goals>
        </execution>
        <execution>
          <id>mvnDeploy</id>
          <phase>deploy</phase>
          <goals>
            <goal>deploy</goal>
          </goals>
        </execution>
      </executions>
    </plugin>
    <plugin>
      <artifactId>maven-antrun-plugin</artifactId>
      <executions>
        <execution>
          <phase>package</phase>
          <configuration>
            <target>
              <copy todir="${basedir}/target/site/">
                <fileset dir="${basedir}/target/openengsb-docs-manual-${project.version}/">
                  <include name="**/*" />
                </fileset>
              </copy>
            </target>
          </configuration>
          <goals>
            <goal>run</goal>
          </goals>
        </execution>
      </executions>
    </plugin>
  </plugins>
</c:config>
